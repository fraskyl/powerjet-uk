---
/**
 * EngineData.astro
 * 
 * Displays engine specifications in a clean card/list format.
 * 
 * Props:
 *   - engineData: Object with manufacturer, model, ratings, emissionCompliancy, fuelConsumption, adblueConsumption
 * 
 * Example usage:
 *   {hasEngineData && engineData && (
 *     <EngineData engineData={engineData} />
 *   )}
 */

import Accordion from '../Layout/Accordion.astro';

interface Props {
  engineData: {
  manufacturer?: string;
  model?: string;
  ratings?: string;
  emissionCompliancy?: string;
  fuelConsumption?: string;
  adblueConsumption?: string;
  };

}

const { engineData } = Astro.props;

// Handle empty or missing data gracefully
if (!engineData) {
  return null;
}

// Filter out empty fields so we only display what we have
const dataEntries = Object.entries(engineData)
  .filter(([_, value]) => value)
  .map(([key, value]) => ({
    key,
    value,
    label: formatLabel(key)
  }));

function formatLabel(key: string): string {
  const labels: Record<string, string> = {
    manufacturer: 'Engine Manufacturer',
    model: 'Engine Model',
    ratings: 'Power Ratings',
    emissionCompliancy: 'Emission Compliance',
    fuelConsumption: 'Fuel Consumption',
    adblueConsumption: 'AdBlue Consumption'
  };
  return labels[key] || key;
}
---

<section class="engine-data__container">
  <!-- Mobile: With Accordion -->
  <div class="mobile-only">
<Accordion defaultOpen={true}>
  <h2 slot="title">Engine Specifications</h2>

  <div class="engine-data__grid">
    {dataEntries.map(({ label, value }) => (
      <div class="engine-data__item">
        <dt class="engine-data__label">{label}</dt>
        <dd class="engine-data__value">{value}</dd>
      </div>
    ))}
  </div>
</Accordion>
  </div>

    <!-- Desktop: No Accordion -->
  <div class="desktop-only">
    <h2>Engine Specifications</h2>
    <div class="engine-data__grid">
      {dataEntries.map(({ label, value }) => (
        <div class="engine-data__item">
          <dt class="engine-data__label">{label}</dt>
          <dd class="engine-data__value">{value}</dd>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  /* Mobile: Show accordion only */
  .mobile-only {
    display: block;
  }
  .desktop-only {
    display: none;
  }

  .engine-data__container {
    grid-column: 1 / -1;
  }

  .engine-data__container h2 {
    font-size: 1.5rem;
    font-weight: 450;
    color: var(--pj_blue_80);
  }

  .engine-data__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1rem;
  }

  .engine-data__item {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }

  .engine-data__label {
    font-size: 0.875rem;
    font-weight: 400;
    letter-spacing: 0.5px;
    color: var(--pj_blue_70);
    margin: 0;
  }

  .engine-data__value {
    font-size: 0.875rem;
    color: var(--pj_blue_80);
    font-weight: 400;
    margin: 0;
  }

  @media screen and (min-width: 768px) {
     /* Desktop: Show regular content */
      .mobile-only {
        display: none;
      }
      .desktop-only {
        display: block;
      }

    .engine-data__container {
      grid-column: 2 / -2;
      padding: 0 1rem;
    }

    .engine-data__container h2 {
      margin-bottom: 2rem;
    } 

    .engine-data__grid {
      grid-template-columns: 1fr;
      gap: 1rem;
    }

  }
</style>
