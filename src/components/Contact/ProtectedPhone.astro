---
// src/components/Contact/ProtectedPhone.astro
interface Props {
  phone: string; // e.g., "+441414405757"
  displayFormat?: string; // e.g., "+44 (0) 141 440 5757"
}

const { phone, displayFormat } = Astro.props;

// Encode phone number
const encodedPhone = Buffer.from(phone).toString('base64');
---

<button 
  class="phone-reveal-btn"
  data-phone={encodedPhone}
  data-display={displayFormat || phone}
>
  <span class="phone-icon">ðŸ“ž</span>
  <span class="phone-text">Click to reveal phone</span>
</button>

<script>
  document.querySelectorAll('.phone-reveal-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const encoded = this.getAttribute('data-phone');
      const display = this.getAttribute('data-display');
      const phone = atob(encoded);
      
      // Create clickable link
      const link = document.createElement('a');
      link.href = `tel:${phone}`;
      link.textContent = display;
      link.className = 'phone-link';
      
      // Replace button with link
      this.parentNode.replaceChild(link, this);
    });
  });
</script>

<style>
  .phone-reveal-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background-color: var(--pj_blue_10);
    border: 1px solid var(--pj_brand_blue);
    border-radius: 0.25rem;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s;
  }
  
  .phone-reveal-btn:hover {
    background-color: var(--pj_blue_20);
  }
  
  .phone-link {
    color: var(--pj_brand_blue);
    font-weight: 500;
    text-decoration: none;
  }
</style>